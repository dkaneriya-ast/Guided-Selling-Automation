<h1 align="center" id="title">Guided Selling Automation</h1>

<p id="description">
This project automates the testing of the Guided Selling Flow on the Afterall platform using Robot Framework and Selenium.  
Its primary objective is to verify that all relevant data is correctly replicated across all locations, based on various combinations of dispositions and service methods.
</p>

<h2>üõ†Ô∏è Installation Steps:</h2>

<p>1. Ensure you have Python installed on your machine.</p>

<p>2. Setup your Project</p>

```
git clone https://github.com/dkaneriya-ast/Guided-Selling-Automation
```

<p>3. Navigate to the project directory</p>

```
cd Guided-Selling-Automation
```

<p>4. Create a new venv in your project root</p> (Do not use <> in the console)

```
python3 -m venv <myenvname> OR python -m venv <venv> 
```

<p>5. Activate the venv </p>

```
venv/Scripts/Activate.ps1
```

<p>6. Run the command below in the project root of the virtual environment (venv) to install all required libraries and dependencies</p>

```
pip install -r requirements.txt
```

<h2>Instructions</h2>

<ol>
<li>
    <strong>Locate the Test Data File</strong>
    <ul>
      <li>Navigate to the <code>Data</code> folder in your project directory.</li>
      <li>You will find an Excel file named <code>locations.xlsx</code>.</li>
    </ul>
  </li>

  <li>
    <strong>Understand the Excel Format</strong>
    <p>This Excel file drives your Robot Framework test suite using the <code>DataDriver</code> library. Each row in the file represents one test case with the following columns:</p>
    <table border="1" cellpadding="6" cellspacing="0">
      <thead>
        <tr>
          <th>Column Index</th>
          <th>Parameter Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>A (1st)</td>
          <td><code>${test case name}</code></td>
          <td>Keep it Empty <strong>Test Cases name are autogenerated during run</strong></td>
        </tr>
        <tr>
          <td>B (2nd)</td>
          <td><code>${url}</code></td>
          <td><strong>Must be filled manually</strong> with the location‚Äôs Guided Selling flow URL.</td>
        </tr>
        <tr>
          <td>C (3rd)</td>
          <td><code>${locationId}</code></td>
          <td><strong>Must be filled manually</strong> with the location‚Äôs Id.</td>
        </tr>
        <tr>
          <td>D to J</td>
          <td>
            <code>${expectedDispositionOptions}</code>,<br>
            <code>${expectedBurialServiceOptions}</code>,<br>
            <code>${expectedBurialFacilities}</code>,<br>
            <code>${expectedBurialNoFacilities}</code>,<br>
            <code>${expectedCremationServiceOptions}</code>,<br>
            <code>${expectedCremationFacilities}</code>,<br>
            <code>${expectedCremationNoFacilities}</code>
          </td>
          <td>These values must be filled manually based on expected results for each location.</td>
        </tr>
      </tbody>
    </table>
  </li>

  <li>
    <strong>Test Parameters Used in Each Row</strong>
    <p>The test will validate the following for each location:</p>
    <ul>
      <li>Disposition options available at the location</li>
      <li>Service methods available for each disposition (e.g., Facilities, No Facilities)</li>
      <li>Package counts for:
        <ul>
          <li>Burial + Facilities</li>
          <li>Burial + No Facilities</li>
          <li>Cremation + Facilities</li>
          <li>Cremation + No Facilities</li>
        </ul>
      </li>
    </ul>
  </li>

  <li>
    <strong>Execute the Test Suite</strong>
    <ul>
      <li>Once the Excel file is filled out, execute the test suite using the Robot Framework test file (e.g., <code>GuidedSellingFlow.robot</code>).</li>
      <li>The <code>DataDriver</code> library will automatically iterate over each row and run validations accordingly.</li>
    </ul>
  </li>

  <li>
    The framework uses <strong>parallel test execution</strong> via <code>pabot</code> to speed up the testing process.
    <ul>
      <li>All test results are collected in runtime memory using Robot Framework‚Äôs parallel-safe variables.</li>
      <li>Once all parallel processes finish execution, a results file is automatically generated as <code>results.xlsx</code> in the <code>Results</code> folder.</li>
    </ul>
  </li>

  <li>
    To run the tests, use the following command:
    <pre><code>pabot --processes 4 --testlevelsplit --variable env:dev --outputdir Results Tests/GuidedSellingFlow.robot</code></pre>
    <ul>
      <li><code>--processes</code>: Number of parallel test runners to use. You can adjust this value based on your system‚Äôs core count (e.g., 2, 4, 6, 8).</li>
      <li><code>--testlevelsplit</code>: Ensures each test case is split and run independently across processes.</li>
      <li><code>--outputdir</code>: Directory where log files and the generated Excel result file will be stored.</li>
      <li><code>----variable env:stg</code>: Sets the environment for the test run. Replace stg with dev or prod to run against a different environment.</li>
    </ul>
  </li>

  <li>
    <strong>Recommended:</strong> Install the 
    <a href="https://marketplace.visualstudio.com/items?itemName=d-biehl.robotcode" target="_blank">
      RobotCode - Robot Framework Support extension for VS Code
    </a>
    for enhanced editing support including syntax highlighting, autocomplete, and test explorer integration.
  </li>
</ol>
